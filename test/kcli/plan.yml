vm3:
  image: fedora37
  numcpus: 2
  memory: 2048
  # output logs from following commands can be found in guest path /var/log/cloud-init-output.log
  cmds:
  - yum -y install openvswitch NetworkManager-ovs jq nmstate
  - systemctl start openvswitch
  - systemctl restart NetworkManager
  - cd /root/mcotest
  - ./test/test-entrypoint.sh 2>&1 > /tmp/test-results.txt
  finishfiles:
  - origin: /tmp/test-results.txt
    path: _data/test-results.txt
  files:
    - origin: ./_data/configure-ovs.sh
      path: /root/mcotest/configure-ovs.sh
      render: False
      mode: 755
    - origin: ./_data/shunit2
      path: /root/mcotest/shunit2
      render: False
      mode: 755
    - origin: ./test/
      path: /root/mcotest/test/
    - path: /
      origin: bonding
    #- path: /etc/NetworkManager/system-connections/bond99.nmconnection
    #  origin: bond99.nmconnection
    #  mode: 600
    #- path: /etc/NetworkManager/system-connections/bond99-slave-eth1.nmconnection
    #  origin: bond99-slave-eth1.nmconnection
    #  mode: 600
    #- path: /etc/NetworkManager/system-connections/bond99-slave-eth2.nmconnection
    #  origin: bond99-slave-eth2.nmconnection
    #  mode: 600

  wait: true
  user: root
  nets:
    - default
    - name: default
      noconf: true
    - name: default
      noconf: true
    - name: default
      noconf: true
    - name: default
      noconf: true
    - name: default
      noconf: true